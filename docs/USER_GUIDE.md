# Руководство пользователя Nota AI

## Введение

Nota AI — это Telegram-бот, предназначенный для быстрой и точной оцифровки бумажных накладных от поставщиков. Бот использует передовые технологии искусственного интеллекта для распознавания текста на фотографиях и сопоставления позиций с вашим каталогом продуктов.

Этот документ содержит подробные инструкции по использованию бота, начиная от первоначальной настройки и заканчивая обработкой сложных инвойсов.

## Начало работы

### Запуск бота

1. Откройте Telegram и найдите бота по его имени (`@NotaAIBot`)
2. Нажмите кнопку "Start" или отправьте команду `/start`
3. Бот приветствует вас и показывает краткую инструкцию:
   ```
   Welcome to Nota AI — a quick way to digitize supplier invoices.
   1) Send a photo.
   2) Review suggestions.
   3) Push to Syrve.
   ```

### Основной интерфейс

После запуска бот покажет главное меню с кнопками:
- **Upload new invoice** - загрузить новую накладную
- **Help** - получить справку по работе бота

## Обработка инвойса

### Шаг 1: Загрузка фотографии

1. Нажмите кнопку "Upload new invoice" или просто отправьте фотографию накладной боту
2. Бот начнет обработку и будет отображать прогресс:
   - Получение изображения
   - Предобработка изображения
   - Распознавание текста (OCR)
   - Сопоставление позиций
   - Формирование отчета

### Шаг 2: Просмотр результатов

После обработки бот покажет отчет о распознанных позициях, содержащий:
- Название поставщика (если распознано)
- Дату накладной (если распознана)
- Список позиций с указанием статуса:
  - ✅ Успешно распознано и сопоставлено
  - ❌ Не удалось сопоставить с каталогом
  - ⚠️ Проблема с единицей измерения

Пример отчета:
```
Invoice Report:
Supplier: ABC Foods
Date: 2025-05-06

Items:
1. ✅ Milk 3.5% - 10 l (150.00)
2. ✅ Eggs - 5 pack (250.00)
3. ❌ Tomato fresh - 2 kg (120.00)
4. ⚠️ Flour - 3 pcs (90.00)

Total: 610.00
```

### Шаг 3: Редактирование

Под отчетом будут доступны кнопки:
- **Edit** - для исправления ошибок и неточностей
- **Cancel** - для отмены обработки
- **Confirm** - для подтверждения и отправки в Syrve (появляется только если все позиции успешно сопоставлены)

#### Режим редактирования

При нажатии на кнопку "Edit" бот переходит в режим редактирования и предлагает ввести команду для изменения данных. Вы можете:

1. **Изменить дату**:
   ```
   date 16 April
   ```

2. **Изменить цену позиции**:
   ```
   row 2 price 95000
   ```

3. **Изменить название позиции**:
   ```
   row 3 name Fresh Tomatoes
   ```

4. **Изменить количество**:
   ```
   row 1 quantity 12
   ```

5. **Изменить единицу измерения**:
   ```
   row 4 unit kg
   ```

#### Множественное редактирование

Вы можете отправить несколько команд за раз, разделяя их запятыми, точками с запятой или точками:
```
row 1 price 120, row 2 quantity 6, date 10 May
```

#### Подсказки для неопознанных позиций

Если позиция не сопоставлена с каталогом, бот может предложить ближайшие совпадения в виде кнопок. Вы можете:
- Выбрать подходящее название из предложенных вариантов
- Ввести правильное название вручную командой редактирования

### Шаг 4: Подтверждение и отправка

После завершения редактирования, когда все позиции будут успешно сопоставлены, появится кнопка "Confirm". При нажатии на нее:

1. Бот создаст XML-документ для Syrve
2. Отправит документ в систему через API
3. Покажет результат операции:
   - Успешно: "Invoice #12345 saved to Syrve. Thank you!"
   - Ошибка: Подробное описание проблемы

## Специальные команды и функции

### Команды бота

- `/start` - запуск бота и показ приветствия
- `/help` - получение справки
- `/cancel` - отмена текущей операции

### Форматы ввода даты

Бот поддерживает различные форматы ввода даты:
- `16 April 2025`
- `16.04.2025`
- `16/04/2025`
- `2025-04-16`
- `April 16`

Если год не указан, используется текущий год.

### Форматы ввода цен

Поддерживаются различные форматы ввода цен:
- `1000` - целое число
- `1000.50` - дробное число с точкой
- `1000,50` - дробное число с запятой
- `1,000.50` - число с разделителями групп разрядов

### Единицы измерения

Поддерживаемые единицы измерения:
- `kg` - килограмм
- `g` - грамм
- `l` - литр
- `ml` - миллилитр
- `pcs` - штуки
- `pack` - упаковка

## Советы по использованию

### Получение наилучших результатов

1. **Фотография накладной**:
   - Снимайте при хорошем освещении
   - Убедитесь, что документ полностью помещается в кадр
   - Избегайте теней и бликов
   - Держите камеру параллельно документу

2. **Редактирование**:
   - Используйте множественное редактирование для быстрого внесения нескольких изменений
   - При исправлении названия проверяйте соответствие каталогу
   - Проверяйте единицы измерения для предотвращения ошибок в количестве

3. **Алиасы**:
   - Система автоматически создает алиасы для высокоуверенных совпадений (≥90%)
   - Со временем распознавание улучшается благодаря накопленным алиасам

### Решение проблем

#### Бот не отвечает

1. Убедитесь, что бот запущен и доступен
2. Проверьте интернет-соединение
3. Попробуйте отправить команду `/start`
4. Если проблема сохраняется, обратитесь к администратору

#### Ошибки распознавания

1. Убедитесь, что изображение четкое и хорошо освещено
2. Попробуйте сделать новый снимок при лучшем освещении
3. Используйте режим редактирования для исправления ошибок

#### Проблемы с отправкой в Syrve

При ошибках отправки в Syrve бот покажет соответствующее сообщение:
- **Ошибка авторизации** - проверьте настройки интеграции
- **Дублирование документа** - документ с таким ID уже существует
- **Ошибка сервера** - временная проблема с Syrve API

## Заключение

Nota AI значительно упрощает и ускоряет процесс ввода данных из бумажных накладных. По мере использования точность распознавания будет улучшаться благодаря механизму алиасов и машинному обучению.

При возникновении проблем или появлении предложений по улучшению функциональности обращайтесь к администратору системы.

## Приложение: Примеры команд редактирования

### Изменение даты
```
date 16 April 2025
date 16.04.2025
date April 16
```

### Изменение поставщика
```
supplier ABC Foods
change supplier to ABC Foods
```

### Редактирование позиций
```
row 1 name Milk 3.5%
row 2 price 95000
row 3 quantity 5
row 4 unit kg
```

### Множественное редактирование
```
row 1 price 120, row 2 quantity 6
date 10 May; supplier XYZ Corp
row 1 name Milk 3.5%. row 2 price 95000. row 3 quantity 5
```