# Руководство пользователя Nota AI

## Введение

Nota AI — это Telegram-бот для быстрой и точной оцифровки накладных поставщиков. Бот использует искусственный интеллект (GPT-4o Vision) для распознавания текста на фотографиях и автоматического сопоставления с вашим каталогом продуктов.

## Начало работы

### Запуск бота

1. Откройте Telegram и найдите бота `@NotaAIBot`
2. Нажмите кнопку "Start" или отправьте команду `/start`
3. Вы увидите приветствие и краткую инструкцию:
   ```
   Welcome to Nota AI — a quick way to digitize supplier invoices.
   1) Send a photo.
   2) Review suggestions.
   3) Push to Syrve.
   ```

## Обработка накладных

### Шаг 1: Загрузка фотографии

1. Нажмите кнопку "Upload new invoice" или просто отправьте фотографию накладной
2. Бот начнет обработку и покажет прогресс:
   - Получение изображения
   - Предобработка изображения
   - Распознавание текста (OCR)
   - Сопоставление позиций
   - Формирование отчета

### Шаг 2: Просмотр результатов

После обработки вы увидите отчет, содержащий:
- Название поставщика и дату
- Таблицу позиций со статусами:
  - ✅ Успешно распознаны и сопоставлены
  - ❓ Не удалось сопоставить с каталогом
  - ⚠️ Проблема с единицей измерения

Пример отчета:
```
Invoice Report:
Supplier: ABC Foods
Date: 2025-05-06
───────────────────

#   NAME               QTY    UNIT     TOTAL
1   Milk 3.5%          10     l        150  ✅ ok
2   Eggs               5      pack     250  ✅ ok
3   Tomato fresh       2      kg       120  ❓ unknown
4   Flour              3      pcs      90   ⚠️ unit_mismatch

───────────────────
Успешно определено: 2 позиции
Требуют подтверждения: 2 позиции

need check
───────────────────
```

### Шаг 3: Редактирование

Под отчетом будут кнопки:
- **✏️ Редактировать** - для исправления ошибок
- **❌ Отмена** - отмена обработки
- **✅ Подтвердить** - подтверждение и отправка в Syrve (появляется, когда все позиции успешно сопоставлены)

#### Как редактировать данные

При нажатии на кнопку "Редактировать" введите команду на естественном языке:

1. **Изменение даты**
   ```
   дата 16 апреля
   ```

2. **Изменение цены**
   ```
   строка 2 цена 95000
   ```

3. **Изменение названия**
   ```
   строка 3 название Свежие Томаты
   ```

4. **Изменение количества**
   ```
   строка 1 количество 12
   ```

5. **Изменение единицы измерения**
   ```
   строка 4 единица измерения кг
   ```

#### Множественное редактирование

Вы можете отправить несколько команд сразу, разделяя их запятыми или точками с запятой:
```
строка 1 цена 120, строка 2 количество 6, дата 10 мая
```

#### Помощь с неопознанными позициями

Для неопознанных товаров (❓) бот предложит похожие варианты из каталога в виде кнопок. Вы можете:
- Выбрать подходящий вариант из предложенных
- Ввести правильное название через команду редактирования

### Шаг 4: Подтверждение и отправка

После редактирования, когда все позиции корректны, нажмите "Подтвердить" для отправки в Syrve.

## Советы по использованию

### Для наилучших результатов

1. **Фотографирование накладных**
   - Снимайте при хорошем освещении
   - Убедитесь, что документ полностью помещается в кадр
   - Избегайте теней и бликов

2. **Редактирование**
   - Используйте множественное редактирование для быстрой коррекции нескольких позиций
   - При исправлении названия убедитесь, что оно соответствует каталогу

3. **Поддерживаемые форматы**
   - **Даты**: "16 апреля", "16.04.2025", "2025-04-16"
   - **Цены**: "1000", "1000.50", "1000,50"
   - **Единицы измерения**: кг, г, л, мл, шт, упак

## Решение проблем

### Ошибки распознавания

1. Сделайте новую фотографию при лучшем освещении
2. Используйте команды редактирования для исправления ошибок

### Проблемы с отправкой в Syrve

При ошибке отправки бот покажет сообщение с описанием проблемы:
- **Ошибка авторизации** - проверьте настройки интеграции
- **Дублирование документа** - накладная с таким ID уже существует
- **Ошибка сервера** - временная проблема с Syrve API 